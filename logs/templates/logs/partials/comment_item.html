<!-- Individual Comment Item -->
<div id="comment-{{ comment.id }}" class="{% if comment.parent_comment %}ml-8 border-l-2 border-[#21262d] pl-4{% endif %}">
    <div class="bg-[#0d1117] border border-[#21262d] rounded-lg p-3">
        <!-- Comment Header -->
        <div class="flex items-start justify-between mb-2">
            <div class="flex items-center gap-2">
                <img src="{{ comment.user.profile_image.url|default:'/static/assets/default-avatar.png' }}" 
                     alt="{{ comment.user.user.username }}"
                     class="w-6 h-6 rounded-full">
                <span class="text-sm font-medium text-gray-300">{{ comment.user.user.username }}</span>
                <span class="text-xs text-gray-500">{{ comment.timestamp|timesince }} ago</span>
            </div>
            
            <!-- Delete Button (only for comment owner or log owner) -->
            {% if request.user.info == comment.user or request.user.info == log.user %}
            <button onclick="deleteComment({{ comment.id }}, '{{ log_sig }}')" 
                    class="text-gray-500 hover:text-red-400 transition-colors">
                <i class="fa fa-trash text-xs"></i>
            </button>
            {% endif %}
        </div>

        <!-- Comment Content -->
        <p class="text-sm text-gray-300 whitespace-pre-wrap">{{ comment.content }}</p>

        <!-- Comment Actions -->
        <div class="flex items-center gap-4 mt-2">
            <button onclick="showReplyForm({{ comment.id }}, '{{ log_sig }}')" 
                    class="text-xs text-gray-500 hover:text-green-400 transition-colors">
                <i class="fa fa-reply mr-1"></i>Reply
            </button>
        </div>

        <!-- Reply Form (Hidden by default) -->
        <div id="reply-form-{{ comment.id }}" class="hidden mt-3">
            <form onsubmit="addComment(event, '{{ log_sig }}', {{ comment.id }}); return false;">
                <textarea 
                    id="reply-input-{{ comment.id }}"
                    class="w-full bg-[#161b22] border border-[#30363d] rounded-lg p-2 text-sm text-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none resize-none"
                    placeholder="Write a reply..."
                    rows="2"
                    maxlength="500"
                    required></textarea>
                <div class="flex justify-end gap-2 mt-2">
                    <button type="button" 
                            onclick="cancelReply({{ comment.id }})"
                            class="px-3 py-1 text-xs text-gray-400 hover:text-gray-300 transition-colors">
                        Cancel
                 </button>
                    <button type="submit" 
                            class="px-3 py-1 bg-green-700 hover:bg-green-600 text-white cursor-pointer text-xs rounded-md transition-colors">
                        Reply
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Replies -->
    <div id="replies-{{ comment.id }}" class="mt-3 space-y-3">
        {% for reply in comment.replies.all %}
            {% include 'logs/partials/comment_item.html' with comment=reply log=log log_sig=log_sig %}
        {% endfor %}
    </div>
</div>
